{% extends "base.html" %}

{% block title %}PubChem API - Chemistry Database{% endblock %}

{% block content %}
<div class="pubchem-page-mega">
    <div class="pubchem-hero">
        <a href="/api-explorer" class="pubchem-back-btn">‚¨ÖÔ∏è All APIs</a>
        
        <div class="pubchem-mascot">üß™</div>
        <h1 class="pubchem-title-mega">PUBCHEM API</h1>
        <p class="pubchem-subtitle">Chemical Compounds Database! ‚öóÔ∏è</p>
    </div>

    <div class="pubchem-search-section">
        <h2 class="pubchem-search-title">üîç Search Compounds!</h2>
        <div class="pubchem-search-box">
            <input type="text" id="pubchem-search" placeholder="Search compound..." value="Water" class="pubchem-input">
            <button onclick="searchCompound()" class="pubchem-search-btn">Search!</button>
        </div>
        
        <div id="pubchem-results" class="pubchem-results-container"></div>
    </div>

    <div class="pubchem-quick-section">
        <h2>‚öóÔ∏è Common Compounds!</h2>
        <div class="pubchem-quick-grid">
            <button class="pubchem-quick-btn" onclick="quickSearch('Water')">üíß Water</button>
            <button class="pubchem-quick-btn" onclick="quickSearch('Salt')">üßÇ Salt</button>
            <button class="pubchem-quick-btn" onclick="quickSearch('Sugar')">üç¨ Sugar</button>
            <button class="pubchem-quick-btn" onclick="quickSearch('Carbon Dioxide')">üí® CO2</button>
            <button class="pubchem-quick-btn" onclick="quickSearch('Oxygen')">üå¨Ô∏è Oxygen</button>
            <button class="pubchem-quick-btn" onclick="quickSearch('Gold')">ü•á Gold</button>
        </div>
    </div>
</div>

<script>
async function searchCompound() {
    const query = document.getElementById('pubchem-search').value;
    const container = document.getElementById('pubchem-results');
    container.innerHTML = '<div class="loading-pubchem">üß™ Searching compounds...</div>';
    
    try {
        // Search for compound
        const searchResp = await fetch(`https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/${encodeURIComponent(query)}/JSON`);
        const data = await searchResp.json();
        
        if (data.PC_Compounds && data.PC_Compounds.length > 0) {
            const compound = data.PC_Compounds[0];
            const cid = compound.id.id.cid;
            
            // Get properties
            const propsResp = await fetch(`https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/${cid}/property/MolecularFormula,MolecularWeight,IUPACName/JSON`);
            const props = await propsResp.json();
            const properties = props.PropertyTable.Properties[0];
            
            container.innerHTML = `
                <div class="compound-card-mega">
                    <div class="compound-header">
                        <h2 class="compound-name">${query}</h2>
                        <div class="compound-cid">CID: ${cid}</div>
                    </div>
                    
                    <div class="compound-image-container">
                        <img src="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/${cid}/PNG" 
                             alt="${query}" 
                             class="compound-image">
                    </div>
                    
                    <div class="compound-properties">
                        <h3>‚öóÔ∏è Properties:</h3>
                        <div class="props-grid">
                            <div class="prop-card">
                                <div class="prop-label">Molecular Formula</div>
                                <div class="prop-value">${properties.MolecularFormula || 'N/A'}</div>
                            </div>
                            <div class="prop-card">
                                <div class="prop-label">Molecular Weight</div>
                                <div class="prop-value">${properties.MolecularWeight || 'N/A'} g/mol</div>
                            </div>
                            ${properties.IUPACName ? `
                                <div class="prop-card full-width">
                                    <div class="prop-label">IUPAC Name</div>
                                    <div class="prop-value">${properties.IUPACName}</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <a href="https://pubchem.ncbi.nlm.nih.gov/compound/${cid}" target="_blank" class="pubchem-link-btn">
                        View Full Details on PubChem ‚Üí
                    </a>
                </div>
            `;
        } else {
            container.innerHTML = '<div class="no-results-pubchem">Compound not found!</div>';
        }
    } catch (e) {
        container.innerHTML = '<div class="error-pubchem">Error loading compound data!</div>';
    }
}

function quickSearch(compound) {
    document.getElementById('pubchem-search').value = compound;
    searchCompound();
}

document.addEventListener('DOMContentLoaded', () => setTimeout(searchCompound, 500));
</script>

<style>
.pubchem-page-mega { min-height: 100vh; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
.pubchem-hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 4rem 2rem; text-align: center; border-radius: 0 0 70px 70px; margin-bottom: 4rem; }
.pubchem-mascot { font-size: 14rem; animation: bounce 2s ease-in-out infinite; }
.pubchem-title-mega { font-family: 'Fredoka One', cursive; font-size: 6rem; color: white; text-shadow: 6px 6px 20px rgba(0,0,0,0.5); margin: 2rem 0; }
.pubchem-search-section { max-width: 1200px; margin: 0 auto 4rem; padding: 0 2rem; }
.pubchem-search-title { font-family: 'Fredoka One', cursive; font-size: 4rem; text-align: center; color: #333; margin-bottom: 2.5rem; }
.pubchem-search-box { display: flex; gap: 1.5rem; margin-bottom: 3rem; }
.pubchem-input { flex: 1; padding: 2rem 2.5rem; border: 6px solid #667eea; border-radius: 50px; font-size: 1.8rem; outline: none; font-weight: bold; }
.pubchem-search-btn { background: linear-gradient(45deg, #ff6b6b, #4ecdc4); border: none; color: white; padding: 2rem 4rem; border-radius: 50px; font-size: 2rem; font-weight: bold; cursor: pointer; transition: all 0.3s ease; }
.compound-card-mega { background: white; border-radius: 35px; padding: 3rem; box-shadow: 0 15px 50px rgba(0,0,0,0.15); border: 6px solid #4ecdc4; }
.compound-header { text-align: center; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 4px solid #f0f0f0; }
.compound-name { font-family: 'Fredoka One', cursive; font-size: 3.5rem; color: #333; margin-bottom: 1rem; }
.compound-cid { font-size: 1.5rem; color: #667eea; font-weight: bold; }
.compound-image-container { text-align: center; margin: 2rem 0; background: #f9f9f9; padding: 2rem; border-radius: 20px; }
.compound-image { max-width: 100%; height: auto; max-height: 400px; }
.compound-properties h3 { font-size: 2.5rem; color: #333; margin-bottom: 2rem; }
.props-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
.prop-card { background: rgba(102,126,234,0.1); padding: 1.5rem; border-radius: 20px; border-left: 5px solid #4ecdc4; }
.prop-card.full-width { grid-column: 1 / -1; }
.prop-label { font-size: 1.1rem; color: #666; font-weight: bold; margin-bottom: 0.5rem; }
.prop-value { font-size: 1.5rem; color: #333; font-weight: bold; }
.pubchem-link-btn { display: block; background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 1.5rem; border-radius: 30px; text-decoration: none; text-align: center; font-size: 1.5rem; font-weight: bold; transition: all 0.3s ease; }
.pubchem-link-btn:hover { transform: scale(1.05); }
.pubchem-quick-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1.5rem; max-width: 1200px; margin: 2rem auto; padding: 0 2rem; }
.pubchem-quick-btn { background: linear-gradient(135deg, #a8edea, #fed6e3); border: none; padding: 1.5rem; border-radius: 25px; font-size: 1.4rem; font-weight: bold; cursor: pointer; border: 4px solid white; transition: all 0.3s ease; }
.pubchem-quick-btn:hover { transform: translateY(-10px); }
</style>
{% endblock %}

