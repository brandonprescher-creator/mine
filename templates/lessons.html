{% extends "base.html" %}

{% block title %}{{ topic.name }} - Lessons{% endblock %}

{% block breadcrumbs %}
{% include 'partials/_breadcrumbs.html' with breadcrumbs=[
    {'title': 'Home', 'url': '/'},
    {'title': 'Subjects', 'url': '/subjects'},
    {'title': topic.subject_name, 'url': '/subject/' + (topic.subject_id|string)},
    {'title': topic.name, 'url': '#'}
] %}
{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- Topic Header -->
    <div class="card-glass p-8 mb-8">
        <h1 class="heading-2 gradient-text mb-3">{{ topic.name }}</h1>
        <p class="text-dark-300 text-lg">{{ topic.description }}</p>
    </div>
    
    <!-- Lessons List -->
    {% if lessons %}
    <div class="mb-8">
        <h2 class="text-2xl font-bold mb-6">Available Lessons</h2>
        <div class="space-y-4">
            {% for lesson in lessons %}
            {% include 'partials/_lesson_card.html' with lesson=lesson %}
            {% endfor %}
        </div>
    </div>
    {% else %}
    {% include 'partials/_empty_state.html' with 
        icon='üìö',
        title='No Lessons Available',
        message='Lessons for this topic are being developed.',
        button_text='Back to Topics',
        button_onclick="history.back()"
    %}
    {% endif %}
    
    <!-- Practice Section -->
    <div class="card-modern mb-8">
        <h3 class="text-xl font-bold mb-4">Practice All</h3>
        <p class="text-dark-400 mb-4">
            Test your knowledge across all lessons in this topic with mixed practice problems
        </p>
        <button class="btn btn-primary" onclick="startMixedPractice()">
            <i class="fas fa-dumbbell mr-2"></i>
            Start Mixed Practice
        </button>
    </div>
    
    <!-- Progress Overview -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="card-modern text-center">
            <div class="text-4xl mb-3">‚úÖ</div>
            <div class="text-3xl font-bold gradient-text mb-2" id="completed-lessons">0</div>
            <div class="text-dark-400">Lessons Completed</div>
        </div>
        <div class="card-modern text-center">
            <div class="text-4xl mb-3">üéØ</div>
            <div class="text-3xl font-bold gradient-text mb-2" id="problems-solved">0</div>
            <div class="text-dark-400">Problems Solved</div>
        </div>
        <div class="card-modern text-center">
            <div class="text-4xl mb-3">‚≠ê</div>
            <div class="text-3xl font-bold gradient-text mb-2" id="mastery-score">0%</div>
            <div class="text-dark-400">Mastery Score</div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function startMixedPractice() {
    const topicId = {{ topic.id }};
    window.location.href = `/practice/topic/${topicId}`;
}

// Load progress stats
async function loadProgress() {
    try {
        const topicId = {{ topic.id }};
        // This would call a backend endpoint for topic progress
        // For now, using placeholder values
        document.getElementById('completed-lessons').textContent = '0';
        document.getElementById('problems-solved').textContent = '0';
        document.getElementById('mastery-score').textContent = '0%';
    } catch (error) {
        console.error('Error loading progress:', error);
    }
}

document.addEventListener('DOMContentLoaded', () => {
    loadProgress();
});
</script>
{% endblock %}